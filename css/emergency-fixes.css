/* Emergency Visual Bug Fixes for HM Herbs */
/* These styles fix critical rendering issues and should load immediately */

/* FLICKER PREVENTION - Hardware acceleration for smooth rendering */
* {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
}

/* EXCEPTION: Products page menu - must allow translateY transforms */
.navbar-menu {
    transform: translateY(-10px) translateZ(0) !important;
    -webkit-transform: translateY(-10px) translateZ(0) !important;
}

.navbar-menu.show {
    transform: translateY(0) translateZ(0) !important;
    -webkit-transform: translateY(0) translateZ(0) !important;
}

/* EXCEPTION: Index.html nav-menu links - remove transforms to fix visibility */
.nav-menu.show a,
.nav-menu.show li {
    transform: none !important;
    -webkit-transform: none !important;
    backface-visibility: visible !important;
    -webkit-backface-visibility: visible !important;
}

/* MOBILE MENU FIXES - Ensure proper overlay and scroll locking */
.mobile-menu-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: rgba(0, 0, 0, 0.5) !important;
    z-index: 999 !important;
    opacity: 0 !important;
    visibility: hidden !important;
    transition: opacity 0.3s ease, visibility 0.3s ease !important;
    pointer-events: none !important;
}

.mobile-menu-overlay.active {
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
}

/* Body scroll locking when mobile menu is open */
body.mobile-menu-open {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
}

/* Ensure mobile menu toggle is always clickable and visible on mobile */
.mobile-menu-toggle {
    pointer-events: auto !important;
    z-index: 1002 !important;
    position: relative !important;
}

/* Force mobile menu toggle to show on mobile screens */
@media (max-width: 768px) {
    .mobile-menu-toggle {
        display: flex !important;
    }
}

/* DESKTOP STICKY NAVBAR ENHANCEMENT - Ensure reliable sticky behavior */
@media (min-width: 769px) {
    .main-header {
        position: -webkit-sticky !important;
        position: sticky !important;
        top: 0 !important;
        z-index: 1020 !important;
        background-color: var(--white) !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
        width: 100% !important;
        margin: 0 !important;
        will-change: transform !important;
        backface-visibility: hidden !important;
        -webkit-backface-visibility: hidden !important;
        transform: translateZ(0) !important;
        -webkit-transform: translateZ(0) !important;
    }
    
    /* Ensure container doesn't interfere with sticky behavior */
    .main-header .container {
        position: relative !important;
        width: 100% !important;
        max-width: 1200px !important;
        margin: 0 auto !important;
    }
    
    /* Ensure navbar has proper background and spacing */
    .main-header .navbar {
        background-color: var(--white) !important;
        padding: var(--space-3) 0 !important;
        width: 100% !important;
    }
    
    /* Add smooth transition for sticky state changes */
    .main-header {
        transition: box-shadow 0.3s ease, background-color 0.3s ease !important;
    }
    
    /* Enhanced sticky state with better shadow */
    .main-header.scrolled {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    }
}

.product-card,
.product-image,
.spotlight-grid,
.product-spotlight {
    will-change: transform;
    transform: translate3d(0, 0, 0);
    -webkit-transform: translate3d(0, 0, 0);
}

/* SCROLLBAR STABILITY - Prevent layout shifts */
html {
    scrollbar-gutter: stable;
    overflow-y: scroll;
}

/* IMAGE LOADING OPTIMIZATION - Smooth image appearance */
img {
    opacity: 0;
    transition: opacity 0.3s ease;
    /* Prevent layout shift by reserving space */
    max-width: 100%;
    height: auto;
    /* Prevent CLS - reserve space for images without dimensions */
    display: block;
}

img.loaded,
img.error,
img[src*="data:"],
.edsa-image img,
img[data-skip-error-handling] {
    opacity: 1;
}

/* CLS Prevention - Reserve space for images without explicit dimensions */
img:not([width]):not([height]):not([style*="aspect-ratio"]) {
    /* Use a safe default aspect ratio to prevent layout shift */
    aspect-ratio: 16 / 9;
    object-fit: cover;
}

/* FALLBACK FOR BROKEN IMAGES - Professional placeholder */
img[src=""],
img:not([src]),
img[alt*="unavailable"] {
    background: #f8f9fa url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2Y4ZjlmYSIvPgo8cmVjdCB4PSI1MCIgeT0iNTAiIHdpZHRoPSIyMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjZTllY2VmIiByeD0iOCIvPgo8Y2lyY2xlIGN4PSIxMDAiIGN5PSI4MCIgcj0iMTUiIGZpbGw9IiNkZWUyZTYiLz4KPHJlY3QgeD0iMTMwIiB5PSI3MCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjgiIGZpbGw9IiNkZWUyZTYiIHJ4PSI0Ii8+CjxyZWN0IHg9IjEzMCIgeT0iODUiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2IiBmaWxsPSIjZGVlMmU2IiByeD0iMyIvPgo8dGV4dCB4PSIxNTAiIHk9IjEzMCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBmaWxsPSIjNmM3NTdkIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5JbWFnZSB1bmF2YWlsYWJsZTwvdGV4dD4KPC9zdmc+') center/contain no-repeat;
    opacity: 1;
    min-height: 200px;
}
